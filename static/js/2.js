/*!
 * build: 2019-07-22 21:16:43
 * hash: c2b35002ec118cb26869
 */
(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{64:function(e,t,g){"use strict";g.d(t,"d",function(){return a}),g.d(t,"b",function(){return c}),g.d(t,"c",function(){return r}),g.d(t,"a",function(){return o});function b(e){if("undefined"!=typeof Range&&Range.prototype.createContextualFragment)return document.createRange().createContextualFragment(e).firstElementChild;var t=document.createElement("div"),n=document.createElement("div");return t.appendChild(n),n.outerHTML=e,t.firstElementChild}function f(e,t){var n=t.showMask,a=void 0!==n&&n,c=t.okText,r=void 0===c?"确认":c,o=t.cancelText,i=void 0===o?"取消":o,l=t.showClose,u=void 0===l||l,s=t.showOk,d=void 0===s||s,m=t.showCancel,v=void 0!==m&&m,b=g(66),f=u?'<a class="'+b.close+' J_close">X</a>':"",p='<div class="'+b.content+'">'+e+"</div>",h=d?'<button class="'+b.okBtn+' J_ok">'+r+"</button>":"",y=v?'<button class="'+b.cancelBtn+' J_cancel">'+i+"</button>":"",_='<div class="'+b.msgbox+' J_msgbox">\n    <div class="'+b.title+'">'+f+"</div>\n    "+p+'\n    <div class="'+b.btns+'">'+h+y+"</div>\n  </div>";return a?'<div class="'+b.mask+'">'+_+"</div>":"<div>"+_+"</div>"}var n,a=function(e,t){var n=(void 0===t?{}:t).duration,a=void 0===n?2e3:n,c=g(65),r=b('<div class="'+c.toast+'">\n    <div class="'+c.msg+'">'+e+"</div>\n  </div>");r&&(document.body.appendChild(r),setTimeout(function(){document.body.removeChild(r)},a))},c=function(e,t){var n=void 0===t?{}:t,a=n.showMask,u=void 0===a||a,c=n.okText,s=void 0===c?"确认":c,r=n.showClose,d=void 0!==r&&r;return new Promise(function(a){var c=b(f(e,{okText:s,showClose:d,showMask:u,showOk:!0})),r=c.querySelector(".J_msgbox"),o=c.querySelector(".J_close"),i=c.querySelector(".J_ok"),l=function(e){if(e.target){var t=e.target,n=r&&r!==t&&!(r.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY);t!==i&&t!==o&&!n||(document.removeEventListener("click",l),document.body.removeChild(c),a(!0))}};document.addEventListener("click",l,!1),document.body.appendChild(c)})},r=function(e,t){var n=void 0===t?{}:t,a=n.showMask,s=void 0===a||a,c=n.okText,d=void 0===c?"确认":c,r=n.cancelText,m=void 0===r?"取消":r,o=n.showClose,v=void 0!==o&&o;return new Promise(function(a){var c=b(f(e,{cancelText:m,okText:d,showCancel:!0,showClose:v,showMask:s,showOk:!0})),r=c.querySelector(".J_msgbox"),o=c.querySelector(".J_close"),i=c.querySelector(".J_ok"),l=c.querySelector(".J_cancel"),u=function(e){if(e.target){var t=e.target,n=r&&r!==t&&!(r.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY);t!==i&&t!==l&&t!==o&&!n||(t===i?a(!0):t!==l&&t!==o&&!n||a(!1),document.removeEventListener("click",u),document.body.removeChild(c))}};document.addEventListener("click",u,!1),document.body.appendChild(c)})},o={dom:(n=g(67),b('<div class="'+n.loading+'"></div>')),show:function(){this.dom&&document.body.appendChild(this.dom)},hide:function(){this.dom&&document.body.removeChild(this.dom)}}},65:function(e,t,n){e.exports={toast:"toast__toast--GBq8a"}},66:function(e,t,n){e.exports={"primary-btn":"msgbox__primary-btn--WbwQ7","cancel-btn":"msgbox__cancel-btn--2cDzz",mask:"msgbox__mask--1u5eH",msgbox:"msgbox__msgbox--9aM53",title:"msgbox__title--3uqf_",close:"msgbox__close--1ybxB",content:"msgbox__content--1wfg-",btns:"msgbox__btns--kqAbc",okBtn:"msgbox__okBtn--3uwjg",cancelBtn:"msgbox__cancelBtn--1g9o7"}},67:function(e,t,n){e.exports={loading:"loading__loading--1NcKg"}},69:function(e,t,n){},70:function(e,t,n){},71:function(e,t,n){},76:function(e,t,n){"use strict";n.r(t);function l(e){var t=e.list,n=e.updateHandler,a=e.removeHandler;if(t.length){var c=function(e){var t=parseInt(e.currentTarget.dataset.id||"",10);t&&n(t)},r=function(e){var t=parseInt(e.currentTarget.dataset.id||"",10);t&&a(t)};return d.a.createElement("table",{className:"account-list"},d.a.createElement("tbody",null,d.a.createElement("tr",null,d.a.createElement("th",null,"名称"),d.a.createElement("th",null,"key"),d.a.createElement("th",null,"每月次数"),d.a.createElement("th",null,"剩余次数"),d.a.createElement("th",null,"操作")),t.map(function(e){return d.a.createElement("tr",{key:e.id},d.a.createElement("td",null,e.name),d.a.createElement("td",null,e.key),d.a.createElement("td",null,e.monthlyLimit),d.a.createElement("td",null,e.remain),d.a.createElement("td",null,d.a.createElement("a",{className:"account-list__btn","data-id":e.id,onClick:c},"编辑"),d.a.createElement("a",{className:"account-list__btn","data-id":e.id,onClick:r},"删除")))})))}return d.a.createElement("div",{className:"account-list-empty"},"暂时没有数据")}function u(e){function t(e){var t,n=e.currentTarget.dataset.key,a=e.currentTarget.value;i(b({},o,((t={})[n]="monthlyLimit"===n?parseInt(a,10)||0:a,t)))}var n=e.data,a=e.submitHandler,c=e.cancelHandler,r=Object(s.useState)(n),o=r[0],i=r[1];return d.a.createElement("div",{className:"account-itemForm"},d.a.createElement("div",{className:"account-itemForm__content"},d.a.createElement("table",{className:"account-itemForm__table"},d.a.createElement("tbody",null,d.a.createElement("tr",null,d.a.createElement("th",null,"名称"),d.a.createElement("td",null,d.a.createElement("input",{className:"account-itemForm__input",type:"text",value:o.name,"data-key":"name",onChange:t}))),d.a.createElement("tr",null,d.a.createElement("th",null,"key"),d.a.createElement("td",null,d.a.createElement("input",{className:"account-itemForm__input",type:"text",value:o.key,"data-key":"key",onChange:t}))),d.a.createElement("tr",null,d.a.createElement("th",null,"每月次数"),d.a.createElement("td",null,d.a.createElement("input",{className:"account-itemForm__input",type:"text",value:o.monthlyLimit,"data-key":"monthlyLimit",onChange:t}))),d.a.createElement("tr",null,d.a.createElement("td",{colSpan:2},d.a.createElement("button",{className:"account-itemForm__btn",onClick:function(){a(o)}},"提交"),d.a.createElement("button",{className:"account-itemForm__btn account-itemForm__btn--cancel",onClick:c},"取消")))))))}var s=n(0),d=n.n(s),m=(n(69),n(15)),v=n(64),b=(n(70),n(71),function(){return(b=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var c in t=arguments[n])Object.prototype.hasOwnProperty.call(t,c)&&(e[c]=t[c]);return e}).apply(this,arguments)}),f=function(r,o,i,l){return new(i=i||Promise)(function(e,t){function n(e){try{c(l.next(e))}catch(e){t(e)}}function a(e){try{c(l.throw(e))}catch(e){t(e)}}function c(t){t.done?e(t.value):new i(function(e){e(t.value)}).then(n,a)}c((l=l.apply(r,o||[])).next())})},p=function(n,a){var c,r,o,e,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(c)throw new TypeError("Generator is already executing.");for(;i;)try{if(c=1,r&&(o=2&t[0]?r.return:t[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,t[1])).done)return o;switch(r=0,o&&(t=[2&t[0],o.value]),t[0]){case 0:case 1:o=t;break;case 4:return i.label++,{value:t[1],done:!1};case 5:i.label++,r=t[1],t=[0];continue;case 7:t=i.ops.pop(),i.trys.pop();continue;default:if(!(o=0<(o=i.trys).length&&o[o.length-1])&&(6===t[0]||2===t[0])){i=0;continue}if(3===t[0]&&(!o||t[1]>o[0]&&t[1]<o[3])){i.label=t[1];break}if(6===t[0]&&i.label<o[1]){i.label=o[1],o=t;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(t);break}o[2]&&i.ops.pop(),i.trys.pop();continue}t=a.call(n,i)}catch(e){t=[6,e],r=0}finally{c=o=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}},h=void 0;t.default=function(){function a(){return f(h,void 0,void 0,function(){var t,n;return p(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,Object(m.a)("/api/tinypng-account")];case 1:return t=e.sent(),o(t.list),[3,3];case 2:return n=e.sent(),Object(v.d)((n.message||"请求失败")+(n.data?": "+n.data.join(","):"")),[3,3];case 3:return[2]}})})}var e=Object(s.useState)(null),t=e[0],c=e[1],n=Object(s.useState)([]),r=n[0],o=n[1];Object(s.useEffect)(function(){a()},[]);function i(){c(null)}return d.a.createElement("div",{className:"tinypng-page"},d.a.createElement("div",{className:"tinypng-page__title"},"tinypng账号管理"),d.a.createElement("div",{className:"tinypng-page__tips"},"因为tinypng每个免费账号一个月只能传500张，这边可以多准备几个账号备用"),d.a.createElement("div",{className:"tinypng-page__btns"},d.a.createElement("button",{className:"tinypng-page__btn",onClick:function(){c({name:"",key:"",monthlyLimit:0})}},"添加"),d.a.createElement("button",{className:"tinypng-page__btn",onClick:function(){return f(h,void 0,void 0,function(){var t;return p(this,function(e){switch(e.label){case 0:v.a.show(),e.label=1;case 1:return e.trys.push([1,3,4,5]),[4,Object(m.a)("/api/tinypng-account/sync",{method:"POST"})];case 2:return e.sent(),Object(v.d)("更新完成"),[3,5];case 3:return t=e.sent(),Object(v.d)(t.message||"更新失败"),[3,5];case 4:return v.a.hide(),[7];case 5:return[2]}})})}},"更新次数")),d.a.createElement("div",{className:"tinypng-page__list"},d.a.createElement(l,{list:r,updateHandler:function(n){return f(h,void 0,void 0,function(){var t;return p(this,function(e){return(t=r.find(function(e){return e.id===n}))&&c(t),[2]})})},removeHandler:function(n){return f(h,void 0,void 0,function(){var t;return p(this,function(e){switch(e.label){case 0:return[4,Object(v.c)("确认删除")];case 1:if(!e.sent())return[3,7];v.a.show(),e.label=2;case 2:return e.trys.push([2,5,6,7]),[4,function(e){return Object(m.a)("/api/tinypng-account/"+e,{method:"DELETE"})}(n)];case 3:return e.sent(),[4,a()];case 4:return e.sent(),[3,7];case 5:return t=e.sent(),Object(v.d)((t.message||"请求失败")+(t.data?": "+t.data.join(","):"")),[3,7];case 6:return v.a.hide(),[7];case 7:return[2]}})})}})),t&&d.a.createElement(u,{data:t,submitHandler:function(n){return f(h,void 0,void 0,function(){var t;return p(this,function(e){switch(e.label){case 0:v.a.show(),e.label=1;case 1:return e.trys.push([1,7,8,9]),n.id?[4,function(e){return Object(m.a)("/api/tinypng-account/"+e.id,{method:"PUT",data:e})}(n)]:[3,3];case 2:return e.sent(),[3,5];case 3:return[4,function(e){return Object(m.a)("/api/tinypng-account",{method:"POST",data:e})}(n)];case 4:e.sent(),e.label=5;case 5:return[4,a()];case 6:return e.sent(),i(),[3,9];case 7:return t=e.sent(),Object(v.d)((t.message||"请求失败")+(t.data?": "+t.data.join(","):"")),[3,9];case 8:return v.a.hide(),[7];case 9:return[2]}})})},cancelHandler:i}))}}}]);