/*!
 * build: 2019-07-22 21:16:43
 * hash: c2b35002ec118cb26869
 */
(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{64:function(e,t,y){"use strict";y.d(t,"d",function(){return o}),y.d(t,"b",function(){return r}),y.d(t,"c",function(){return c}),y.d(t,"a",function(){return i});function v(e){if("undefined"!=typeof Range&&Range.prototype.createContextualFragment)return document.createRange().createContextualFragment(e).firstElementChild;var t=document.createElement("div"),n=document.createElement("div");return t.appendChild(n),n.outerHTML=e,t.firstElementChild}function b(e,t){var n=t.showMask,o=void 0!==n&&n,r=t.okText,c=void 0===r?"确认":r,i=t.cancelText,a=void 0===i?"取消":i,u=t.showClose,l=void 0===u||u,s=t.showOk,d=void 0===s||s,m=t.showCancel,f=void 0!==m&&m,v=y(66),b=l?'<a class="'+v.close+' J_close">X</a>':"",p='<div class="'+v.content+'">'+e+"</div>",h=d?'<button class="'+v.okBtn+' J_ok">'+c+"</button>":"",w=f?'<button class="'+v.cancelBtn+' J_cancel">'+a+"</button>":"",g='<div class="'+v.msgbox+' J_msgbox">\n    <div class="'+v.title+'">'+b+"</div>\n    "+p+'\n    <div class="'+v.btns+'">'+h+w+"</div>\n  </div>";return o?'<div class="'+v.mask+'">'+g+"</div>":"<div>"+g+"</div>"}var n,o=function(e,t){var n=(void 0===t?{}:t).duration,o=void 0===n?2e3:n,r=y(65),c=v('<div class="'+r.toast+'">\n    <div class="'+r.msg+'">'+e+"</div>\n  </div>");c&&(document.body.appendChild(c),setTimeout(function(){document.body.removeChild(c)},o))},r=function(e,t){var n=void 0===t?{}:t,o=n.showMask,l=void 0===o||o,r=n.okText,s=void 0===r?"确认":r,c=n.showClose,d=void 0!==c&&c;return new Promise(function(o){var r=v(b(e,{okText:s,showClose:d,showMask:l,showOk:!0})),c=r.querySelector(".J_msgbox"),i=r.querySelector(".J_close"),a=r.querySelector(".J_ok"),u=function(e){if(e.target){var t=e.target,n=c&&c!==t&&!(c.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY);t!==a&&t!==i&&!n||(document.removeEventListener("click",u),document.body.removeChild(r),o(!0))}};document.addEventListener("click",u,!1),document.body.appendChild(r)})},c=function(e,t){var n=void 0===t?{}:t,o=n.showMask,s=void 0===o||o,r=n.okText,d=void 0===r?"确认":r,c=n.cancelText,m=void 0===c?"取消":c,i=n.showClose,f=void 0!==i&&i;return new Promise(function(o){var r=v(b(e,{cancelText:m,okText:d,showCancel:!0,showClose:f,showMask:s,showOk:!0})),c=r.querySelector(".J_msgbox"),i=r.querySelector(".J_close"),a=r.querySelector(".J_ok"),u=r.querySelector(".J_cancel"),l=function(e){if(e.target){var t=e.target,n=c&&c!==t&&!(c.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY);t!==a&&t!==u&&t!==i&&!n||(t===a?o(!0):t!==u&&t!==i&&!n||o(!1),document.removeEventListener("click",l),document.body.removeChild(r))}};document.addEventListener("click",l,!1),document.body.appendChild(r)})},i={dom:(n=y(67),v('<div class="'+n.loading+'"></div>')),show:function(){this.dom&&document.body.appendChild(this.dom)},hide:function(){this.dom&&document.body.removeChild(this.dom)}}},65:function(e,t,n){e.exports={toast:"toast__toast--GBq8a"}},66:function(e,t,n){e.exports={"primary-btn":"msgbox__primary-btn--WbwQ7","cancel-btn":"msgbox__cancel-btn--2cDzz",mask:"msgbox__mask--1u5eH",msgbox:"msgbox__msgbox--9aM53",title:"msgbox__title--3uqf_",close:"msgbox__close--1ybxB",content:"msgbox__content--1wfg-",btns:"msgbox__btns--kqAbc",okBtn:"msgbox__okBtn--3uwjg",cancelBtn:"msgbox__cancelBtn--1g9o7"}},67:function(e,t,n){e.exports={loading:"loading__loading--1NcKg"}},68:function(e,t,n){e.exports={item:"index__item--cEmGf",itemComplete:"index__itemComplete--2i8gG index__item--cEmGf",itemImcomplete:"index__itemImcomplete--29wfA index__item--cEmGf",btn:"index__btn--2nX0D",inputName:"index__inputName--BqyPd"}},72:function(e,t){e.exports=function(e){if(navigator.clipboard)return navigator.clipboard.writeText(e);var t=document.createElement("span");t.textContent=e,t.style.whiteSpace="pre",document.body.appendChild(t);var n=window.getSelection(),o=window.document.createRange();n.removeAllRanges(),o.selectNode(t),n.addRange(o);var r=!1;try{r=window.document.execCommand("copy")}catch(e){console.log("error",e)}return n.removeAllRanges(),window.document.body.removeChild(t),r?Promise.resolve():Promise.reject()}},73:function(e,t,n){e.exports={imgList:"index__imgList--1ojM4",loadMore:"index__loadMore--4jeYW"}},75:function(e,t,n){"use strict";n.r(t);function o(e){var o=e.item,t=Object(u.a)(o.originSize),n=Object(u.a)(o.size);return _.a.createElement("div",{className:m.itemComplete},_.a.createElement("div",{style:{backgroundImage:"url("+function(e){var t=e.thumb||e.name;return"https://"+e.path+"/"+t}(o)+")"}}),_.a.createElement("div",null,_.a.createElement("input",{className:m.inputName,type:"text",readOnly:!0,value:o.name})),_.a.createElement("div",null,"[",o.width,"x",o.height,"] (",t.format+t.unit,"->",n.format+n.unit,")"),_.a.createElement("div",null,_.a.createElement("a",{className:m.btn,onClick:function(){window.open("https://"+o.path+"/"+o.name)}},"打开"),_.a.createElement("a",{className:m.btn,onClick:function(){return s(void 0,void 0,void 0,function(){return d(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,4]),[4,a()("https://"+o.path+"/"+o.name)];case 1:return e.sent(),Object(l.d)("已经复制至剪贴板"),[3,4];case 2:return e.sent(),[4,Object(l.b)("https://"+o.path+"/"+o.name)];case 3:return e.sent(),Object(l.d)("复制失败"),[3,4];case 4:return[2]}})})}},"复制"),_.a.createElement("a",{className:m.btn,onClick:function(){return s(void 0,void 0,void 0,function(){var t,n;return d(this,function(e){switch(e.label){case 0:return t="https://"+o.path+"/"+o.name,[4,Object(u.b)(t)];case 1:n=e.sent(),e.label=2;case 2:return e.trys.push([2,4,,6]),[4,a()(n)];case 3:return e.sent(),Object(l.d)("已经复制至剪贴板"),[3,6];case 4:return e.sent(),[4,Object(l.b)(n)];case 5:return e.sent(),Object(l.d)("复制失败"),[3,6];case 6:return[2]}})})}},"BASE64")))}function r(e){var t=e.item;return _.a.createElement("div",{className:f.itemImcomplete},_.a.createElement("div",null,"无预览"),_.a.createElement("div",null,t.name),_.a.createElement("div",null),_.a.createElement("div",null,function(e){return{1:"待处理",2:"压缩中",3:"压缩失败",4:"待上传",5:"发布中",6:"发布失败",7:"已完成",8:"已删除"}[e.status]}(t)))}function g(e){var t=e.item;return 7===t.status?_.a.createElement(o,{item:t}):_.a.createElement(r,{item:t})}function y(e){var o=Object(x.useRef)(e),t=Object(x.useState)([]),n=t[0],r=t[1],c=Object(x.useState)([]),i=c[0],a=c[1];return Object(x.useEffect)(function(){o.current=o.current.concat(i)},[i]),Object(x.useEffect)(function(){var e=window.setInterval(function(){return k(void 0,void 0,void 0,function(){var t,n;return O(this,function(e){switch(e.label){case 0:return o.current.length?[4,function(e){return Object(E.a)("/api/img/status",{params:{imageIds:e}})}(o.current)]:[3,2];case 1:t=e.sent(),n=t.filter(function(e){return![7,8].includes(e.status)}),o.current=n.map(function(e){return e.id}),r(t),e.label=2;case 2:return[2]}})})},3e3);return function(){window.clearInterval(e)}},[]),[{tickRes:n},a]}function c(e){function t(){return k(void 0,void 0,void 0,function(){var t,n,o;return O(this,function(e){switch(e.label){case 0:return t=u.length?u[u.length-1].id:0,[4,function(e,t){return void 0===t&&(t=0),Object(E.a)("/api/img",{params:{limit:e,last:t}})}(r,t)];case 1:return n=e.sent(),l(u.concat(n)),b(!1),n.length<r&&m(!0),o=n.filter(function(e){return![7,8].includes(e.status)}).map(function(e){return e.id}),w(o),[2]}})})}var n=e.perPage,r=void 0===n?30:n,o=e.tickList,c=void 0===o?[]:o,i=Object(x.useRef)(null),a=Object(x.useState)([]),u=a[0],l=a[1],s=Object(x.useState)(!1),d=s[0],m=s[1],f=Object(x.useState)(!1),v=f[0],b=f[1],p=y(c),h=p[0].tickRes,w=p[1];return Object(x.useEffect)(function(){console.log("tick"),h.length&&l(u.map(function(t){var e=h.find(function(e){return e.id===t.id});return e||t}))},[h]),Object(x.useEffect)(function(){v&&!d&&t()},[v,d]),Object(x.useEffect)(function(){function e(){if(!v&&!d&&i.current){var e=i.current.offsetTop,t=document.documentElement.scrollTop||document.body.scrollTop;e<(document.body.clientHeight||document.documentElement.clientHeight)+t&&b(!0)}}return t(),window.addEventListener("scroll",e,!1),function(){window.removeEventListener("scroll",e)}},[]),_.a.createElement("div",{className:C.container},_.a.createElement("div",{className:C.imgList},u.map(function(e){return _.a.createElement(g,{key:e.id,item:e})})),_.a.createElement("div",{className:C.loadMore,ref:i},d?"end":"loading"))}var x=n(0),_=n.n(x),E=n(15),i=n(72),a=n.n(i),u=n(12),l=n(64),s=function(c,i,a,u){return new(a=a||Promise)(function(e,t){function n(e){try{r(u.next(e))}catch(e){t(e)}}function o(e){try{r(u.throw(e))}catch(e){t(e)}}function r(t){t.done?e(t.value):new a(function(e){e(t.value)}).then(n,o)}r((u=u.apply(c,i||[])).next())})},d=function(n,o){var r,c,i,e,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,c&&(i=2&t[0]?c.return:t[0]?c.throw||((i=c.return)&&i.call(c),0):c.next)&&!(i=i.call(c,t[1])).done)return i;switch(c=0,i&&(t=[2&t[0],i.value]),t[0]){case 0:case 1:i=t;break;case 4:return a.label++,{value:t[1],done:!1};case 5:a.label++,c=t[1],t=[0];continue;case 7:t=a.ops.pop(),a.trys.pop();continue;default:if(!(i=0<(i=a.trys).length&&i[i.length-1])&&(6===t[0]||2===t[0])){a=0;continue}if(3===t[0]&&(!i||t[1]>i[0]&&t[1]<i[3])){a.label=t[1];break}if(6===t[0]&&a.label<i[1]){a.label=i[1],i=t;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(t);break}i[2]&&a.ops.pop(),a.trys.pop();continue}t=o.call(n,a)}catch(e){t=[6,e],c=0}finally{r=i=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}},m=n(68),f=n(68),k=function(c,i,a,u){return new(a=a||Promise)(function(e,t){function n(e){try{r(u.next(e))}catch(e){t(e)}}function o(e){try{r(u.throw(e))}catch(e){t(e)}}function r(t){t.done?e(t.value):new a(function(e){e(t.value)}).then(n,o)}r((u=u.apply(c,i||[])).next())})},O=function(n,o){var r,c,i,e,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,c&&(i=2&t[0]?c.return:t[0]?c.throw||((i=c.return)&&i.call(c),0):c.next)&&!(i=i.call(c,t[1])).done)return i;switch(c=0,i&&(t=[2&t[0],i.value]),t[0]){case 0:case 1:i=t;break;case 4:return a.label++,{value:t[1],done:!1};case 5:a.label++,c=t[1],t=[0];continue;case 7:t=a.ops.pop(),a.trys.pop();continue;default:if(!(i=0<(i=a.trys).length&&i[i.length-1])&&(6===t[0]||2===t[0])){a=0;continue}if(3===t[0]&&(!i||t[1]>i[0]&&t[1]<i[3])){a.label=t[1];break}if(6===t[0]&&a.label<i[1]){a.label=i[1],i=t;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(t);break}i[2]&&a.ops.pop(),a.trys.pop();continue}t=o.call(n,a)}catch(e){t=[6,e],c=0}finally{r=i=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}},C=n(73);c.prototype.xxx="zzzzzzzz";var v=c;t.default=function(){return _.a.createElement("div",{className:"image-page"},_.a.createElement(v,null))}}}]);